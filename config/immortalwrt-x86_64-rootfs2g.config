# =========================================================
# ImmortalWrt x86_64 generic - rootfs 2G
# LuCI + HTTPS via Nginx (avoid libustream openssl/mbedtls clash)
# HomeProxy(sing-box) + DDNS + Docker/Dockerman
# =========================================================

# -------------------------
# Target / Rootfs size
# -------------------------
CONFIG_TARGET_x86=y
CONFIG_TARGET_x86_64=y
CONFIG_TARGET_x86_64_DEVICE_generic=y

# rootfs partition size (MB) -> 2G
CONFIG_TARGET_ROOTFS_PARTSIZE=2048

# images
CONFIG_TARGET_IMAGES_GZIP=y
CONFIG_TARGET_ROOTFS_TARGZ=y
CONFIG_TARGET_ROOTFS_EXT4FS=y

# -------------------------
# LuCI + HTTPS (Nginx)
# -------------------------
CONFIG_PACKAGE_luci=y

# IMPORTANT: use nginx ssl profile instead of luci-ssl (uhttpd+libustream)
CONFIG_PACKAGE_luci-ssl-nginx=y
CONFIG_PACKAGE_nginx-ssl=y

# Make sure we DON'T pull uhttpd+libustream https path
# (These lines help keep defconfig from selecting the uhttpd ssl stack)
# CONFIG_PACKAGE_luci-ssl is not set
# CONFIG_PACKAGE_uhttpd is not set
# CONFIG_PACKAGE_uhttpd-mod-ubus is not set
# CONFIG_PACKAGE_libustream-openssl is not set
# CONFIG_PACKAGE_libustream-openssl20201210 is not set
# CONFIG_PACKAGE_libustream-mbedtls is not set
# CONFIG_PACKAGE_libustream-mbedtls20201210 is not set

# -------------------------
# HomeProxy + sing-box
# -------------------------
CONFIG_PACKAGE_homeproxy=y
CONFIG_PACKAGE_luci-app-homeproxy=y
CONFIG_PACKAGE_sing-box=y
CONFIG_PACKAGE_ca-bundle=y

# -------------------------
# Firewall (nftables)
# -------------------------
CONFIG_PACKAGE_firewall4=y
CONFIG_PACKAGE_nftables=y
CONFIG_PACKAGE_kmod-tun=y

# -------------------------
# DDNS
# -------------------------
CONFIG_PACKAGE_ddns-scripts=y
CONFIG_PACKAGE_luci-app-ddns=y
CONFIG_PACKAGE_curl=y

# -------------------------
# Docker + Dockerman
# -------------------------
CONFIG_PACKAGE_docker=y
CONFIG_PACKAGE_luci-app-dockerman=y

# -------------------------
# Disk / Mount helpers (for external disk)
# -------------------------
CONFIG_PACKAGE_block-mount=y
CONFIG_PACKAGE_e2fsprogs=y
CONFIG_PACKAGE_e2fsprogs-fsck=y
CONFIG_PACKAGE_parted=y
CONFIG_PACKAGE_fdisk=y

# -------------------------
# QoL / Troubleshooting
# -------------------------
CONFIG_PACKAGE_htop=y
CONFIG_PACKAGE_iftop=y
CONFIG_PACKAGE_ip-full=y
CONFIG_PACKAGE_tcpdump=y
CONFIG_PACKAGE_wget-ssl=y
CONFIG_PACKAGE_openssh-sftp-server=y

# -------------------------
# DNS (optional)
# -------------------------
CONFIG_PACKAGE_dnsmasq-full=y
